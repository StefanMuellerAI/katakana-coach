{% extends "layout.html" %}

{% block title %}Katakana Lernen{% endblock %}

{% block content %}
<audio id="correctSound" src="/static/quiz_correct_answer.mp3"></audio>

<div class="max-w-md mx-auto bg-white rounded-xl shadow-md overflow-hidden md:max-w-2xl">
    <div class="p-8">
        <h2 class="text-2xl font-semibold mb-4">Kannst du das Katakana lesen? Probiere es aus!</h2>
        <div id="question-container">
            <p id="question-type" class="text-gray-600 mb-4"></p>
            <p id="question" class="text-4xl font-bold text-center mb-6"></p>
            <div id="options" class="flex justify-between space-x-2 mb-4"></div>
            <input type="text" id="romanji-input" class="w-full p-2 border rounded mb-4 text-2xl text-center" style="display: none;">
        </div>
        <div id="result-container" class="mb-6 hidden">
            <p id="result-text" class="text-xl font-bold text-center mb-4"></p>
            <p id="correct-answer" class="text-gray-600 text-center"></p>
            <p id="example" class="text-gray-600 text-center mt-2"></p>
        </div>
        <div class="mt-6 space-y-2">
            <button id="next-question" class="w-full bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded">
                Nächste Frage
            </button>
        </div>
        <div class="mt-6">
            <ins class="adsbygoogle"
                style="display:block"
                data-ad-client="ca-pub-XXXXXXXXXXXXXXXX"
                data-ad-slot="XXXXXXXXXX"
                data-ad-format="auto"></ins>
        </div>
    </div>
</div>
<script>
let currentQuestion = null;
let katakanaSegments = [];
const japaneseDict = {
'ア': {'hiragana': 'あ', 'romanji': 'a', 'example': 'アイス (aisu, Eis)'},
'イ': {'hiragana': 'い', 'romanji': 'i', 'example': 'イチゴ (ichigo, Erdbeere)'},
'ウ': {'hiragana': 'う', 'romanji': 'u', 'example': 'ウサギ (usagi, Hase)'},
'エ': {'hiragana': 'え', 'romanji': 'e', 'example': 'エレベーター (erebētā, Aufzug)'},
'オ': {'hiragana': 'お', 'romanji': 'o', 'example': 'オレンジ (orenji, Orange)'},
'カ': {'hiragana': 'か', 'romanji': 'ka', 'example': 'カメラ (kamera, Kamera)'},
'キ': {'hiragana': 'き', 'romanji': 'ki', 'example': 'キツネ (kitsune, Fuchs)'},
'ク': {'hiragana': 'く', 'romanji': 'ku', 'example': 'クッキー (kukkī, Keks)'},
'ケ': {'hiragana': 'け', 'romanji': 'ke', 'example': 'ケーキ (kēki, Kuchen)'},
'コ': {'hiragana': 'こ', 'romanji': 'ko', 'example': 'コーヒー (kōhī, Kaffee)'},
'サ': {'hiragana': 'さ', 'romanji': 'sa', 'example': 'サッカー (sakkā, Fußball)'},
'シ': {'hiragana': 'し', 'romanji': 'shi', 'example': 'シャツ (shatsu, Hemd)'},
'ス': {'hiragana': 'す', 'romanji': 'su', 'example': 'スシ (sushi, Sushi)'},
'セ': {'hiragana': 'せ', 'romanji': 'se', 'example': 'セーター (sētā, Pullover)'},
'ソ': {'hiragana': 'そ', 'romanji': 'so', 'example': 'ソファ (sofa, Sofa)'},
'タ': {'hiragana': 'た', 'romanji': 'ta', 'example': 'タクシー (takushī, Taxi)'},
'チ': {'hiragana': 'ち', 'romanji': 'chi', 'example': 'チーズ (chīzu, Käse)'},
'ツ': {'hiragana': 'つ', 'romanji': 'tsu', 'example': 'ツリー (tsurī, Baum)'},
'テ': {'hiragana': 'て', 'romanji': 'te', 'example': 'テレビ (terebi, Fernseher)'},
'ト': {'hiragana': 'と', 'romanji': 'to', 'example': 'トマト (tomato, Tomate)'},
'ナ': {'hiragana': 'な', 'romanji': 'na', 'example': 'ナイフ (naifu, Messer)'},
'ニ': {'hiragana': 'に', 'romanji': 'ni', 'example': 'ニュース (nyūsu, Nachrichten)'},
'ヌ': {'hiragana': 'ぬ', 'romanji': 'nu', 'example': 'ヌードル (nūdoru, Nudeln)'},
'ネ': {'hiragana': 'ね', 'romanji': 'ne', 'example': 'ネコ (neko, Katze)'},
'ノ': {'hiragana': 'の', 'romanji': 'no', 'example': 'ノート (nōto, Notizbuch)'},
'ハ': {'hiragana': 'は', 'romanji': 'ha', 'example': 'ハンバーガー (hanbāgā, Hamburger)'},
'ヒ': {'hiragana': 'ひ', 'romanji': 'hi', 'example': 'ヒマワリ (himawari, Sonnenblume)'},
'フ': {'hiragana': 'ふ', 'romanji': 'fu', 'example': 'フルーツ (furūtsu, Obst)'},
'ヘ': {'hiragana': 'へ', 'romanji': 'he', 'example': 'ヘリコプター (herikoputā, Hubschrauber)'},
'ホ': {'hiragana': 'ほ', 'romanji': 'ho', 'example': 'ホテル (hoteru, Hotel)'},
'マ': {'hiragana': 'ま', 'romanji': 'ma', 'example': 'マンゴー (mangō, Mango)'},
'ミ': {'hiragana': 'み', 'romanji': 'mi', 'example': 'ミルク (miruku, Milch)'},
'ム': {'hiragana': 'む', 'romanji': 'mu', 'example': 'ムシ (mushi, Insekt)'},
'メ': {'hiragana': 'め', 'romanji': 'me', 'example': 'メガネ (megane, Brille)'},
'モ': {'hiragana': 'も', 'romanji': 'mo', 'example': 'モモ (momo, Pfirsich)'},
'ヤ': {'hiragana': 'や', 'romanji': 'ya', 'example': 'ヤキソバ (yakisoba, gebratene Nudeln)'},
'ユ': {'hiragana': 'ゆ', 'romanji': 'yu', 'example': 'ユキ (yuki, Schnee)'},
'ヨ': {'hiragana': 'よ', 'romanji': 'yo', 'example': 'ヨーグルト (yōguruto, Joghurt)'},
'ラ': {'hiragana': 'ら', 'romanji': 'ra', 'example': 'ラジオ (rajio, Radio)'},
'リ': {'hiragana': 'り', 'romanji': 'ri', 'example': 'リンゴ (ringo, Apfel)'},
'ル': {'hiragana': 'る', 'romanji': 'ru', 'example': 'ルビー (rubī, Rubin)'},
'レ': {'hiragana': 'れ', 'romanji': 're', 'example': 'レモン (remon, Zitrone)'},
'ロ': {'hiragana': 'ろ', 'romanji': 'ro', 'example': 'ロボット (robotto, Roboter)'},
'ワ': {'hiragana': 'わ', 'romanji': 'wa', 'example': 'ワイン (wain, Wein)'},
'ヲ': {'hiragana': 'を', 'romanji': 'wo', 'example': 'ヲタク (wotaku, Otaku)'},
'ン': {'hiragana': 'ん', 'romanji': 'n', 'example': 'パン (pan, Brot)'},
'ガ': {'hiragana': 'が', 'romanji': 'ga', 'example': 'ガム (gamu, Kaugummi)'},
'ギ': {'hiragana': 'ぎ', 'romanji': 'gi', 'example': 'ギター (gitā, Gitarre)'},
'グ': {'hiragana': 'ぐ', 'romanji': 'gu', 'example': 'グラス (gurasu, Glas)'},
'ゲ': {'hiragana': 'げ', 'romanji': 'ge', 'example': 'ゲーム (gēmu, Spiel)'},
'ゴ': {'hiragana': 'ご', 'romanji': 'go', 'example': 'ゴリラ (gorira, Gorilla)'},
'ザ': {'hiragana': 'ざ', 'romanji': 'za', 'example': 'ザリガニ (zarigani, Flusskrebs)'},
'ジ': {'hiragana': 'じ', 'romanji': 'ji', 'example': 'ジュース (jūsu, Saft)'},
'ズ': {'hiragana': 'ず', 'romanji': 'zu', 'example': 'ズボン (zubon, Hose)'},
'ゼ': {'hiragana': 'ぜ', 'romanji': 'ze', 'example': 'ゼリー (zerī, Gelee)'},
'ゾ': {'hiragana': 'ぞ', 'romanji': 'zo', 'example': 'ゾウ (zō, Elefant)'},
'ダ': {'hiragana': 'だ', 'romanji': 'da', 'example': 'ダイヤモンド (daiyamondo, Diamant)'},
'ヂ': {'hiragana': 'ぢ', 'romanji': 'ji', 'example': 'ヂェット (jetto, Jet)'},
'ヅ': {'hiragana': 'づ', 'romanji': 'zu', 'example': 'ヅカ (zuka, Grabhügel)'},
'デ': {'hiragana': 'で', 'romanji': 'de', 'example': 'デザート (dezāto, Dessert)'},
'ド': {'hiragana': 'ど', 'romanji': 'do', 'example': 'ドア (doa, Tür)'},
'バ': {'hiragana': 'ば', 'romanji': 'ba', 'example': 'バナナ (banana, Banane)'},
'ビ': {'hiragana': 'び', 'romanji': 'bi', 'example': 'ビール (bīru, Bier)'},
'ブ': {'hiragana': 'ぶ', 'romanji': 'bu', 'example': 'ブドウ (budō, Traube)'},
'ベ': {'hiragana': 'べ', 'romanji': 'be', 'example': 'ベッド (beddo, Bett)'},
'ボ': {'hiragana': 'ぼ', 'romanji': 'bo', 'example': 'ボール (bōru, Ball)'},
'パ': {'hiragana': 'ぱ', 'romanji': 'pa', 'example': 'パスタ (pasuta, Pasta)'},
'ピ': {'hiragana': 'ぴ', 'romanji': 'pi', 'example': 'ピアノ (piano, Klavier)'},
'プ': {'hiragana': 'ぷ', 'romanji': 'pu', 'example': 'プール (pūru, Schwimmbad)'},
'ペ': {'hiragana': 'ぺ', 'romanji': 'pe', 'example': 'ペン (pen, Stift)'},
'ポ': {'hiragana': 'ぽ', 'romanji': 'po', 'example': 'ポケット (poketto, Tasche)'},
'キャ': {'hiragana': 'きゃ', 'romanji': 'kya', 'example': 'キャベツ (kyabetsu, Kohl)'},
'キュ': {'hiragana': 'きゅ', 'romanji': 'kyu', 'example': 'キュウリ (kyūri, Gurke)'},
'キョ': {'hiragana': 'きょ', 'romanji': 'kyo', 'example': 'キョウト (kyōto, Kyoto)'},
'シャ': {'hiragana': 'しゃ', 'romanji': 'sha', 'example': 'シャワー (shawā, Dusche)'},
'シュ': {'hiragana': 'しゅ', 'romanji': 'shu', 'example': 'シュークリーム (shūkurīmu, Windbeutel)'},
'ショ': {'hiragana': 'しょ', 'romanji': 'sho', 'example': 'ショッピング (shoppingu, Einkaufen)'},
'チャ': {'hiragana': 'ちゃ', 'romanji': 'cha', 'example': 'チャーハン (chāhan, gebratener Reis)'},
'チュ': {'hiragana': 'ちゅ', 'romanji': 'chu', 'example': 'チューリップ (chūrippu, Tulpe)'},
'チョ': {'hiragana': 'ちょ', 'romanji': 'cho', 'example': 'チョコレート (chokorēto, Schokolade)'},
'ニャ': {'hiragana': 'にゃ', 'romanji': 'nya', 'example': 'ニャンコ (nyanko, Kätzchen)'},
'ニュ': {'hiragana': 'にゅ', 'romanji': 'nyu', 'example': 'ニュース (nyūsu, Nachrichten)'},
'ニョ': {'hiragana': 'にょ', 'romanji': 'nyo', 'example': 'ニョロニョロ (nyoronyoro, schleimig)'},
'ヒャ': {'hiragana': 'ひゃ', 'romanji': 'hya', 'example': 'ヒャクエン (hyakuen, 100 Yen)'},
'ヒュ': {'hiragana': 'ひゅ', 'romanji': 'hyu', 'example': 'ヒューズ (hyūzu, Sicherung)'},
'ヒョ': {'hiragana': 'ひょ', 'romanji': 'hyo', 'example': 'ヒョウ (hyō, Leopard)'},
'ミャ': {'hiragana': 'みゃ', 'romanji': 'mya', 'example': 'ミャンマー (myanmā, Myanmar)'},
'ミュ': {'hiragana': 'みゅ', 'romanji': 'myu', 'example': 'ミュージック (myūjikku, Musik)'},
'ミョ': {'hiragana': 'みょ', 'romanji': 'myo', 'example': 'ミョウガ (myōga, Ingwerlilie)'},
'リャ': {'hiragana': 'りゃ', 'romanji': 'rya', 'example': 'リャマ (ryama, Lama)'},
'リュ': {'hiragana': 'りゅ', 'romanji': 'ryu', 'example': 'リュック (ryukku, Rucksack)'},
'リョ': {'hiragana': 'りょ', 'romanji': 'ryo', 'example': 'リョカン (ryokan, traditionelles japanisches Gasthaus)'},
'ギャ': {'hiragana': 'ぎゃ', 'romanji': 'gya', 'example': 'ギャラリー (gyararī, Galerie)'},
'ギュ': {'hiragana': 'ぎゅ', 'romanji': 'gyu', 'example': 'ギュウニュウ (gyūnyū, Milch)'},
'ギョ': {'hiragana': 'ぎょ', 'romanji': 'gyo', 'example': 'ギョウザ (gyōza, Teigtaschen)'},
'ジャ': {'hiragana': 'じゃ', 'romanji': 'ja', 'example': 'ジャケット (jaketto, Jacke)'},
'ジュ': {'hiragana': 'じゅ', 'romanji': 'ju', 'example': 'ジュース (jūsu, Saft)'},
'ジョ': {'hiragana': 'じょ', 'romanji': 'jo', 'example': 'ジョギング (jogingu, Joggen)'},
'ビャ': {'hiragana': 'びゃ', 'romanji': 'bya', 'example': 'ビャクダン (byakudan, Sandelholz)'},
'ビュ': {'hiragana': 'びゅ', 'romanji': 'byu', 'example': 'ビュッフェ (byuffe, Buffet)'},
'ビョ': {'hiragana': 'びょ', 'romanji': 'byo', 'example': 'ビョウイン (byōin, Krankenhaus)'},
'ピャ': {'hiragana': 'ぴゃ', 'romanji': 'pya', 'example': 'ピャオ (pyao, Ticket)'},
'ピュ': {'hiragana': 'ぴゅ', 'romanji': 'pyu', 'example': 'ピューマ (pyūma, Puma)'},
'ピョ': {'hiragana': 'ぴょ', 'romanji': 'pyo', 'example': 'ピョンピョン (pyonpyon, hüpfend)'},
    'ー': {'hiragana': '', 'romanji': 'ー', 'example': ''},
    'ヴ': {'hiragana': 'ゔ', 'romanji': 'vu', 'example': 'ヴァイオリン (vaiorin, Violine)'},
'ファ': {'hiragana': 'ふぁ', 'romanji': 'fa', 'example': 'ファン (fan, Fan)'},
'フィ': {'hiragana': 'ふぃ', 'romanji': 'fi', 'example': 'フィルム (firumu, Film)'},
'フェ': {'hiragana': 'ふぇ', 'romanji': 'fe', 'example': 'フェリー (ferī, Fähre)'},
'フォ': {'hiragana': 'ふぉ', 'romanji': 'fo', 'example': 'フォーク (fōku, Gabel)'},
'ウィ': {'hiragana': 'うぃ', 'romanji': 'wi', 'example': 'ウィスキー (wisukī, Whiskey)'},
'ウェ': {'hiragana': 'うぇ', 'romanji': 'we', 'example': 'ウェブ (webu, Web)'},
'ウォ': {'hiragana': 'うぉ', 'romanji': 'wo', 'example': 'ウォーター (wōtā, Wasser)'},
'ティ': {'hiragana': 'てぃ', 'romanji': 'ti', 'example': 'パーティー (pātī, Party)'},
'ディ': {'hiragana': 'でぃ', 'romanji': 'di', 'example': 'メロディー (merodī, Melodie)'},
'トゥ': {'hiragana': 'とぅ', 'romanji': 'tu', 'example': 'トゥナイト (tunaito, heute Abend)'},
'ドゥ': {'hiragana': 'どぅ', 'romanji': 'du', 'example': 'ドゥエット (duetto, Duett)'},
'ツァ': {'hiragana': 'つぁ', 'romanji': 'tsa', 'example': 'ピツァ (pitsa, Pizza)'},
'ツィ': {'hiragana': 'つぃ', 'romanji': 'tsi', 'example': 'ツィゴイネルワイゼン (tsigoineruwaizen, Zigeunerweisen)'},
'ツェ': {'hiragana': 'つぇ', 'romanji': 'tse', 'example': 'ツェッペリン (tsepperin, Zeppelin)'},
'ツォ': {'hiragana': 'つぉ', 'romanji': 'tso', 'example': 'ツォンガ (tsonga, Tsonga)'},
    'ッ': {'hiragana': 'っ', 'romanji': '', 'example': ''}  // Small tsu
};
function playCorrectSound() {
    const audio = document.getElementById('correctSound');
    audio.play();
}
function loadQuestion() {
    fetch('/get_question')
        .then(response => {
            if (!response.ok) {
                throw new Error('Network response was not ok ' + response.statusText);
            }
            return response.json();
        })
        .then(data => {
            if (!data.question || !data.correct_answer) {
                throw new Error('Invalid data format: Missing question or correct_answer');
            }

            currentQuestion = data;
            const questionType = document.getElementById('question-type');
            const questionElement = document.getElementById('question');
            const optionsContainer = document.getElementById('options');
            const romanjiInput = document.getElementById('romanji-input');

            optionsContainer.innerHTML = '';
            romanjiInput.style.display = 'none';

            switch (data.mode) {
                case 'katakana_to_romanji':
                    questionType.textContent = "Wie lautet das Romanji für:";
                    questionElement.textContent = data.question;
                    break;
                case 'romanji_to_katakana':
                    questionType.textContent = "Wie lautet das Katakana für:";
                    questionElement.textContent = data.question;
                    break;
                case 'katakana_to_hiragana':
                    questionType.textContent = "Wie lautet das Hiragana für:";
                    questionElement.textContent = data.question;
                    break;
                case 'hiragana_to_katakana':
                    questionType.textContent = "Wie lautet das Katakana für:";
                    questionElement.textContent = data.question;
                    break;
                case 'word_to_romanji':
                    questionType.textContent = "Gib das Romanji für dieses Wort ein:";
                    romanjiInput.style.display = 'block';
                    romanjiInput.value = '';
                    katakanaSegments = segmentKatakana(data.question);
                    questionElement.innerHTML = `
                        ${colorKatakana('')}
                        <br>
                        <span class="text-sm text-gray-500">(${data.german_translation})</span>
                    `;
                    break;
                default:
                    throw new Error('Unknown mode: ' + data.mode);
            }

            if (data.mode !== 'word_to_romanji') {
                data.options.forEach((option, index) => {
                    const button = document.createElement('button');
                    button.innerHTML = `<span class="text-3xl">${option}</span><span class="sr-only">${index + 1}</span>`;
                    button.className = 'flex-1 bg-blue-600 hover:bg-blue-700 text-white font-bold py-4 px-6 rounded text-center';
                    button.onclick = () => checkAnswer(option);
                    optionsContainer.appendChild(button);
                });
            }

            document.getElementById('question-container').classList.remove('hidden');
            document.getElementById('result-container').classList.add('hidden');

            // Reload AdSense ad
            try {
                (adsbygoogle = window.adsbygoogle || []).push({});
            } catch (e) {
                console.error('AdSense load error:', e);
            }
        })
        .catch(error => {
            console.error('Error loading question:', error);
            alert('Ein Fehler ist aufgetreten. Bitte versuche es später erneut.');
        });
}

function segmentKatakana(katakana) {
    let segments = [];
    let index = 0;

    while (index < katakana.length) {
        let char = katakana[index];
        let nextChar = index + 1 < katakana.length ? katakana[index + 1] : '';

        if (char === 'ッ') {
            // Handle small tsu
            segments.push({
                katakana: char,
                romanji: ''  // We'll handle this in colorKatakana
            });
            index++;
        } else if (char === 'ー') {
            // Handle long vowel
            segments.push({
                katakana: char,
                romanji: ''  // We'll handle this in colorKatakana
            });
            index++;
        } else if (japaneseDict[char + nextChar]) {
            // Handle compound characters
            char += nextChar;
            segments.push({
                katakana: char,
                romanji: japaneseDict[char].romanji
            });
            index += 2;
        } else if (japaneseDict[char]) {
            // Handle single characters
            segments.push({
                katakana: char,
                romanji: japaneseDict[char].romanji
            });
            index++;
        } else {
            console.error('Undefined katakana:', char);
            index++;
        }
    }

    console.log('Segments:', segments);
    return segments;
}

// Aktualisierte colorKatakana Funktion
function colorKatakana(input) {
    let coloredKatakana = '';
    let inputIndex = 0;
    let allCorrect = true;
    let expectedRomanji = '';

    console.log('User input:', input);

    for (let i = 0; i < katakanaSegments.length; i++) {
        const segment = katakanaSegments[i];
        let segmentRomanji = segment.romanji.toLowerCase();

        // Handle small tsu
        if (segment.katakana === 'ッ' && i + 1 < katakanaSegments.length) {
            const nextSegment = katakanaSegments[i + 1];
            segmentRomanji = nextSegment.romanji[0].toLowerCase();
            expectedRomanji += segmentRomanji;
        }
        // Handle long vowel
        else if (segment.katakana === 'ー' && i > 0) {
            const prevSegment = katakanaSegments[i - 1];
            const prevVowel = prevSegment.romanji[prevSegment.romanji.length - 1].toLowerCase();
            segmentRomanji = prevVowel;
            expectedRomanji += segmentRomanji;
        }
        else {
            expectedRomanji += segmentRomanji;
        }

        const remainingInput = input.toLowerCase().slice(inputIndex);

        console.log(`Segment ${i}:`, segment);
        console.log('Expected Romanji:', segmentRomanji);
        console.log('Remaining Input:', remainingInput);

        if (remainingInput.startsWith(segmentRomanji)) {
            coloredKatakana += `<span style="color: green;">${segment.katakana}</span>`;
            inputIndex += segmentRomanji.length;
        } else {
            coloredKatakana += `<span style="color: red;">${segment.katakana}</span>`;
            allCorrect = false;
        }
    }

    console.log('Colored Katakana:', coloredKatakana);
    console.log('Expected Romanji:', expectedRomanji);

    // Check if the input is correct and complete
    if (allCorrect && input.toLowerCase() === expectedRomanji) {
        setTimeout(() => {
            playCorrectSound();
            loadQuestion();
        }, 500); // Short delay to let the user see the fully green word
    }

    return coloredKatakana;
}

function checkAnswer(answer) {
    const isCorrect = answer.toLowerCase().trim() === currentQuestion.correct_answer.toLowerCase().trim();
    showResult(isCorrect);
}

function showResult(isCorrect) {
    const resultText = document.getElementById('result-text');
    const correctAnswer = document.getElementById('correct-answer');
    const example = document.getElementById('example');

    if (isCorrect) {
        resultText.textContent = 'Richtig! Gut gemacht!';
        resultText.className = 'text-green-600 font-bold text-xl mb-4';
        correctAnswer.textContent = '';
        playCorrectSound();
    } else {
        resultText.textContent = 'Leider falsch.';
        resultText.className = 'text-red-600 font-bold text-xl mb-2';
        correctAnswer.textContent = `Die richtige Antwort ist: ${currentQuestion.correct_answer}`;
    }

    example.textContent = currentQuestion.example ? `Beispiel: ${currentQuestion.example}` : '';

    document.getElementById('question-container').classList.add('hidden');
    document.getElementById('result-container').classList.remove('hidden');
}

document.getElementById('next-question').addEventListener('click', loadQuestion);

document.getElementById('romanji-input').addEventListener('input', function(e) {
    const input = e.target.value;
    document.getElementById('question').innerHTML = colorKatakana(input.replace(/-/g, 'ー'));
});

document.addEventListener('keydown', function(event) {
    if (currentQuestion && currentQuestion.mode !== 'word_to_romanji') {
        if (event.key >= '1' && event.key <= '3') {
            const index = parseInt(event.key) - 1;
            const options = document.querySelectorAll('#options button');
            if (index < options.length) {
                options[index].click();
            }
        } else if (event.key === 'Enter') {
            if (document.getElementById('result-container').classList.contains('hidden')) {
                // If the result is not shown, select the first option
                const firstOption = document.querySelector('#options button');
                if (firstOption) {
                    firstOption.click();
                }
            } else {
                // If the result is shown, load the next question
                loadQuestion();
            }
        }
    }
});

// Load the first question when the page loads
loadQuestion();
</script>




{% endblock %}
